(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{62:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return l}));var o=n(3),r=n(7),a=(n(0),n(90)),s={title:"User Configuration"},c={unversionedId:"setup/user-config",id:"setup/user-config",isDocsHomePage:!1,title:"User Configuration",description:"Now that our control node is running, we need to be able to access it.",source:"@site/docs/setup/user-config.md",slug:"/setup/user-config",permalink:"/k8s-notes/setup/user-config",editUrl:"https://github.com/jasonk/k8s-notes/edit/main/docs/setup/user-config.md",version:"current",sidebar:"docs",previous:{title:"Adding Worker Nodes",permalink:"/k8s-notes/setup/worker-nodes"},next:{title:"Dashboard",permalink:"/k8s-notes/setup/dashboard"}},i=[],u={rightToc:i};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Now that our control node is running, we need to be able to access it.\nLet's get the ",Object(a.b)("inlineCode",{parentName:"p"},"root")," user on the control node setup first."),Object(a.b)("p",null,"When we initialized the cluster, ",Object(a.b)("inlineCode",{parentName:"p"},"kubeadm")," created a config file that\nhas all of the information we need to use ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," to connect to and\nmanage the cluster.  It stored this file in\n",Object(a.b)("inlineCode",{parentName:"p"},"/etc/kubernetes/admin.conf"),".  In order to use ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," as the root\nuser without having to pass a flag pointing at that config file every\ntime, we'll just make a symlink to make that file also appear in our\n",Object(a.b)("inlineCode",{parentName:"p"},"~/.kube")," directory."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"mkdir -p ~/.kube\nln -sf /etc/kubernetes/admin.conf ~/.kube/config\n")),Object(a.b)("p",null,"Now you should be able to use ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," to access the cluster.  Try\nsome of these commands out:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"kubectl cluster-info\nkubectl get pods --all-namespaces\n")),Object(a.b)("p",null,"Having access to this as ",Object(a.b)("inlineCode",{parentName:"p"},"root")," is great, but generally you don't want\nto spend too much time logged in as ",Object(a.b)("inlineCode",{parentName:"p"},"root"),", so let's set up a regular\nuser also."),Object(a.b)("p",null,'You may have created a user account for yourself while installing\nDebian, if so you can use that account and skip this next part.  If\nyou didn\'t do that then you can create a new user now.  In the\nexamples that follow you probably want to replace "jason" with your\nown name (unless you happen to also be a Jason, then you are in\nluck!).'),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"useradd --user-group --create-home --comment \"Jason\" jason\necho 'jason ALL=(ALL) NOPASSWD:ALL' > /etc/sudoers.d/jason\nmkdir -p ~jason/.kube\ncp /etc/kubernetes/admin.conf ~jason/.kube/config\nchown -R jason:jason ~jason/.kube\npasswdd jason\n")),Object(a.b)("p",null,"Now, BEFORE YOU LOGOUT OF YOUR ROOT SHELL!  Open up a new terminal,\nlogin to the control node as your new user, and use ",Object(a.b)("inlineCode",{parentName:"p"},"sudo -i")," to get\na new root terminal.  If all goes well, you can now logout of the root\nshell in both terminals.  You want to make sure all goes well before\nyou logout of the first terminal though, because if you mess up the\nsudo config you could lock yourself out and it would take quite a bit\nmore effort to get logged back in as root."),Object(a.b)("h1",{id:"workstation-setup"},"Workstation Setup"),Object(a.b)("p",null,"In some of the upcoming steps you are going to want to be able to\naccess these cluster tools from your desktop, especially for the\nservices we're going to setup that have web interfaces.  The\ninstructions that follow should happen on your desktop or laptop\nmachine, not on the cluster itself."),Object(a.b)("p",null,"To start out we're going to install ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," on your workstation.  If\nyou are on a Mac and have ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://brew.sh/"}),"Homebrew")," installed, or\non Windows and have ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://chocolatey.org/"}),"Chocolatey")," then you can\nuse those to easily install it.  If your workstation is Debian or\nUbuntu you can use the same instructions we used earlier to install it\non the cluster control node.   For other options see the docs at\n",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"}),"Install Kubectl")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"# Mac\nbrew install kubernetes-cli helm\n\n# Windows:\nchoco install kubernetes-cli kubernetes-helm\n")),Object(a.b)("p",null,"Now we're going to make a ",Object(a.b)("inlineCode",{parentName:"p"},".kube")," directory just like we did for the\nroot user, and copy that same config file into that directory."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"mkdir -p ~/.kube\nscp jason@cluster.local:.kube/config ~/.kube\n")),Object(a.b)("p",null,"Once that is done you should be able to run ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," from a terminal\non your desktop machine just like you did remotely.  Try running\n",Object(a.b)("inlineCode",{parentName:"p"},"kubectl cluster-info")," again just to make sure everything works."))}l.isMDXComponent=!0},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var o=n(0),r=n.n(o);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=r.a.createContext({}),l=function(e){var t=r.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=l(e.components);return r.a.createElement(u.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=l(n),d=o,m=p["".concat(s,".").concat(d)]||p[d]||b[d]||a;return n?r.a.createElement(m,c(c({ref:t},u),{},{components:n})):r.a.createElement(m,c({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,s[1]=c;for(var u=2;u<a;u++)s[u]=n[u];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);