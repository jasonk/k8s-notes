<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<title data-react-helmet="true">Dashboard | Jason&#x27;s Kubernetes Notes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Dashboard | Jason&#x27;s Kubernetes Notes"><meta data-react-helmet="true" name="description" content="Let&#x27;s install our first application, the Kubernetes Dashboard.  This"><meta data-react-helmet="true" property="og:description" content="Let&#x27;s install our first application, the Kubernetes Dashboard.  This"><meta data-react-helmet="true" property="og:url" content="https://jasonkohles.com/k8s-notes/setup/dashboard"><link data-react-helmet="true" rel="shortcut icon" href="/k8s-notes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jasonkohles.com/k8s-notes/setup/dashboard"><link rel="stylesheet" href="/k8s-notes/styles.e8739408.css">
<link rel="preload" href="/k8s-notes/styles.69075ca6.js" as="script">
<link rel="preload" href="/k8s-notes/runtime~main.583d16d4.js" as="script">
<link rel="preload" href="/k8s-notes/main.8ee242e7.js" as="script">
<link rel="preload" href="/k8s-notes/1.d74cfc91.js" as="script">
<link rel="preload" href="/k8s-notes/25.575fc837.js" as="script">
<link rel="preload" href="/k8s-notes/935f2afb.ead8358e.js" as="script">
<link rel="preload" href="/k8s-notes/24.e6edf205.js" as="script">
<link rel="preload" href="/k8s-notes/7a5c3817.3a5808d5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/k8s-notes/"><strong class="navbar__title">Jason&#x27;s Kubernetes Notes</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jasonk/k8s-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/k8s-notes/"><strong class="navbar__title">Jason&#x27;s Kubernetes Notes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/jasonk/k8s-notes" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/">Welcome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/about/links">Helpful Kubernetes Links</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/control-node">Control Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/worker-nodes">Adding Worker Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/user-config">User Configuration</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/k8s-notes/setup/dashboard">Dashboard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/helm">Helm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/operators-and-openebs">Operators and OpenEBS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/jsonnet-and-prometheus">Jsonnet and Prometheus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/metallb">MetalLB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/nginx-ingress">Nginx Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/exploring-pods">Exploring Pods</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/control-plane">Control Plane</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/operators">Operators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/tainting">Taints and Tolerations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/apps/argocd">ArgoCD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/apps/cert-manager">cert-manager</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/advanced/multi-tenancy">Multi-Tenancy Best Practices</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Dashboard</h1></header><div class="markdown"><p>Let&#x27;s install our first application, the Kubernetes Dashboard.  This
is a nice web-based UI that lets you acecss and manage your cluster
from a web browser.</p><p>Deploying the dashboard is very easy:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>However, just deploying it isn&#x27;t very interesting, you also need to be
able to access it.  Run <code>kubectl get pods --all-namepsaces</code> to see the
status of all the pods in your cluster.  If you are a fast reader then
parts of the dashboard pods may still be deploying.  Check back in
a minute or two, once <code>kubectl get pods</code> says that all of your pods
are in <code>Running</code> status then you are ready to continue.</p><p>The first problem with accessing it is that the dashboard is running
on a pod inside the cluster.  Kubernetes networking by default allows
all the pods to talk to each other, but you aren&#x27;t a pod and your
desktop isn&#x27;t inside the cluster (even if the cluster is running in
a VM on your desktop).  To fix that, <code>kubectl</code> has a trick up it&#x27;s
sleeve.  On your desktop machine open up a new shell, stick it out of
the way in a corner somewhere, and in that shell run <code>kubectl proxy</code>.
You should get a message that says <code>Starting to serve on
127.0.0.1:8001</code>.  This means that <code>kubectl</code> is now running a proxy
server that can give the browser on your desktop access to things
running inside the cluster.</p><p>To try it out, visit this URL in your browser:
http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</p><p>You should get a page that says &#x27;Kubernetes Dashboard&#x27; that asks you
to pick either <code>Token</code> or <code>Kubeconfig</code> authentication.  Unfortunately
neither of these will work to let us in just yet, so we&#x27;re going to
use this opportunity to learn how to create a user.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-a-user"></a>Adding a User<a aria-hidden="true" class="hash-link" href="#adding-a-user" title="Direct link to heading">#</a></h1><p>We&#x27;re going to make an admin service account that matches our user
account name on the cluster server.</p><p>To do that, we&#x27;re going to create a <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer">YAML</a> file
with the configuration we need and then use <code>kubectl</code> to apply it.
This is a very common activity when managing Kubernetes, so this is
a good chance to learn it.</p><p>Create a file with either a <code>.yaml</code> or <code>.yml</code> extension.  I called
mine <code>service-account-jason.yaml</code>.  The contents of this file are
going to become very familiar as we continue.  For Kubernetes these
files nearly always have the same sections: <code>apiVersion</code> (indicating
the version of the API that the rest of the config file is assuming),
<code>kind</code> (the kind of resource that is being provisioned in the cluster,
and <code>metadata</code> (information about the resource being provisioned).
There are other sections that may show up depending on thekind of
resource being provisioned, but these three are in basically every
file.  If you ever have questions about what options are available for
a certain kind of resource, <code>kubectl</code> can answer that question for
you!  Try it out now by running <code>kubectl explain serviceaccount</code> to
see what fields are available when defining a service account.</p><p>Now start out your config file with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ServiceAccount</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dashboard</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This says we want to create a service account with the name <code>jason</code>
and give it access to the <code>kubernetes-dashboard</code> namespace.  As is
often the case with Kubernetes resources, this one item alone isn&#x27;t
enough to get you the access you need, you also need
a <code>ClusterRoleBinding</code> to connect this service account to a role that
defines what it is allowed to do.  You could put the configuration for
this binding into another file, but YAML allows you to put multiple
documents into one file, which makes it easier to keep related things
together.  All you have to do is include a line with nothing but three
dashes as a document separator, and then you can start another
document.  So now, add these lines to your service account yaml file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterRoleBinding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">roleRef</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterRole</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">subjects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ServiceAccount</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dashboard</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now you just need to apply that file to your cluster:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ./service-account-jason.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>If all went well you now have a service account that has cluster-admin
permissions to the <code>kubernetes-dashboard</code> namespace.  All you need to
do now is to get a token for it.  To do that, first list the secrets
in that namespace:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl -n kubernetes-dashboard get secret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>You&#x27;ll get back a list that includes several things that were
automatically created when you setup the cluster, but you should also
see a fairly new one that starts with <code>jason-token-</code>, that&#x27;s the one
you want.  Now that you know what it&#x27;s called, you can ask <code>kubectl</code>
to tell you about it.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl -n kubernetes-dashboard describe secret jason-token-w9rbz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This will give you a bunch of information about the secret, and near
the end will be a huge block of text labeled <code>token</code>.  You want to
copy just the big blob of characters (without including the <code>token:</code>
at the beginning, then go back to the browser you opened earlier
to the Kubernetes Dashboard.  Make sure the <code>Token</code> option is
selected, and paste that big blob into the field that says <code>Enter
token</code>.</p><p>Now all that is left is to click &quot;Sign In&quot;. and you should be looking
at the dashboard for your cluster.  To see everything in the cluster,
find the <code>Namespace</code> menu on the left side of the screen, and change
it from where it currently is (probably &quot;default&quot;) to &quot;All
namespaces&quot;.  Now you can click through the other options in the left
side of the screen to see all the parts of your cluster that you just
built.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="cleaning-up"></a>Cleaning Up<a aria-hidden="true" class="hash-link" href="#cleaning-up" title="Direct link to heading">#</a></h1><p>If you decide later that you want to get rid of this service account,
you can either tell <code>kubectl</code> to delete the resources using the same
file you used to create them:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete -f ./service-account-jason.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Or you can just manually delete the two resources that were created:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl -n kubernetes-dashboard delete serviceaccount jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl -n kubernetes-dashboard delete clusterrolebinding jason</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/jasonk/k8s-notes/edit/main/docs/setup/dashboard.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/k8s-notes/setup/user-config"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« User Configuration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/k8s-notes/setup/helm"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Helm Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2020 Jason Kohles</div></div></div></footer></div>
<script src="/k8s-notes/styles.69075ca6.js"></script>
<script src="/k8s-notes/runtime~main.583d16d4.js"></script>
<script src="/k8s-notes/main.8ee242e7.js"></script>
<script src="/k8s-notes/1.d74cfc91.js"></script>
<script src="/k8s-notes/25.575fc837.js"></script>
<script src="/k8s-notes/935f2afb.ead8358e.js"></script>
<script src="/k8s-notes/24.e6edf205.js"></script>
<script src="/k8s-notes/7a5c3817.3a5808d5.js"></script>
</body>
</html>