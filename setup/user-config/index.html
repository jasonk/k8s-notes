<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<title data-react-helmet="true">User Configuration | Jason&#x27;s Kubernetes Notes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="User Configuration | Jason&#x27;s Kubernetes Notes"><meta data-react-helmet="true" name="description" content="Now that our control node is running, we need to be able to access it."><meta data-react-helmet="true" property="og:description" content="Now that our control node is running, we need to be able to access it."><meta data-react-helmet="true" property="og:url" content="https://jasonkohles.com/k8s-notes/setup/user-config"><link data-react-helmet="true" rel="shortcut icon" href="/k8s-notes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jasonkohles.com/k8s-notes/setup/user-config"><link rel="stylesheet" href="/k8s-notes/styles.e8739408.css">
<link rel="preload" href="/k8s-notes/styles.69075ca6.js" as="script">
<link rel="preload" href="/k8s-notes/runtime~main.a4215b58.js" as="script">
<link rel="preload" href="/k8s-notes/main.3878add6.js" as="script">
<link rel="preload" href="/k8s-notes/1.d74cfc91.js" as="script">
<link rel="preload" href="/k8s-notes/25.575fc837.js" as="script">
<link rel="preload" href="/k8s-notes/935f2afb.93050429.js" as="script">
<link rel="preload" href="/k8s-notes/24.e6edf205.js" as="script">
<link rel="preload" href="/k8s-notes/13e78a50.8a02b856.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/k8s-notes/"><strong class="navbar__title">Jason&#x27;s Kubernetes Notes</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jasonk/k8s-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/k8s-notes/"><strong class="navbar__title">Jason&#x27;s Kubernetes Notes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/jasonk/k8s-notes" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/">Welcome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/about/links">Helpful Kubernetes Links</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/control-node">Control Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/worker-nodes">Adding Worker Nodes</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/k8s-notes/setup/user-config">User Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/dashboard">Dashboard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/helm">Helm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/operators-and-openebs">Operators and OpenEBS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/jsonnet-and-prometheus">Jsonnet and Prometheus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/metallb">MetalLB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/nginx-ingress">Nginx Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8s-notes/setup/exploring-pods">Exploring Pods</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/control-plane">Control Plane</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/operators">Operators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/concepts/tainting">Taints and Tolerations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/apps/argocd">ArgoCD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8s-notes/apps/cert-manager">cert-manager</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">User Configuration</h1></header><div class="markdown"><p>Now that our control node is running, we need to be able to access it.
Let&#x27;s get the <code>root</code> user on the control node setup first.</p><p>When we initialized the cluster, <code>kubeadm</code> created a config file that
has all of the information we need to use <code>kubectl</code> to connect to and
manage the cluster.  It stored this file in
<code>/etc/kubernetes/admin.conf</code>.  In order to use <code>kubectl</code> as the root
user without having to pass a flag pointing at that config file every
time, we&#x27;ll just make a symlink to make that file also appear in our
<code>~/.kube</code> directory.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p ~/.kube</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ln -sf /etc/kubernetes/admin.conf ~/.kube/config</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now you should be able to use <code>kubectl</code> to access the cluster.  Try
some of these commands out:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cluster-info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods --all-namespaces</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Having access to this as <code>root</code> is great, but generally you don&#x27;t want
to spend too much time logged in as <code>root</code>, so let&#x27;s set up a regular
user also.</p><p>You may have created a user account for yourself while installing
Debian, if so you can use that account and skip this next part.  If
you didn&#x27;t do that then you can create a new user now.  In the
examples that follow you probably want to replace &quot;jason&quot; with your
own name (unless you happen to also be a Jason, then you are in
luck!).</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">useradd --user-group --create-home --comment &quot;Jason&quot; jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">echo &#x27;jason ALL=(ALL) NOPASSWD:ALL&#x27; &gt; /etc/sudoers.d/jason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p ~jason/.kube</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cp /etc/kubernetes/admin.conf ~jason/.kube/config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">chown -R jason:jason ~jason/.kube</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">passwdd jason</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now, BEFORE YOU LOGOUT OF YOUR ROOT SHELL!  Open up a new terminal,
login to the control node as your new user, and use <code>sudo -i</code> to get
a new root terminal.  If all goes well, you can now logout of the root
shell in both terminals.  You want to make sure all goes well before
you logout of the first terminal though, because if you mess up the
sudo config you could lock yourself out and it would take quite a bit
more effort to get logged back in as root.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="workstation-setup"></a>Workstation Setup<a aria-hidden="true" class="hash-link" href="#workstation-setup" title="Direct link to heading">#</a></h1><p>In some of the upcoming steps you are going to want to be able to
access these cluster tools from your desktop, especially for the
services we&#x27;re going to setup that have web interfaces.  The
instructions that follow should happen on your desktop or laptop
machine, not on the cluster itself.</p><p>To start out we&#x27;re going to install <code>kubectl</code> on your workstation.  If
you are on a Mac and have <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew</a> installed, or
on Windows and have <a href="https://chocolatey.org/" target="_blank" rel="noopener noreferrer">Chocolatey</a> then you can
use those to easily install it.  If your workstation is Debian or
Ubuntu you can use the same instructions we used earlier to install it
on the cluster control node.   For other options see the docs at
<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">Install Kubectl</a></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sh codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Mac</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">brew install kubernetes-cli helm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Windows:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">choco install kubernetes-cli kubernetes-helm</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now we&#x27;re going to make a <code>.kube</code> directory just like we did for the
root user, and copy that same config file into that directory.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p ~/.kube</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">scp jason@cluster.local:.kube/config ~/.kube</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Once that is done you should be able to run <code>kubectl</code> from a terminal
on your desktop machine just like you did remotely.  Try running
<code>kubectl cluster-info</code> again just to make sure everything works.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/jasonk/k8s-notes/edit/main/docs/setup/user-config.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/k8s-notes/setup/worker-nodes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Adding Worker Nodes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/k8s-notes/setup/dashboard"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dashboard Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2020 Jason Kohles</div></div></div></footer></div>
<script src="/k8s-notes/styles.69075ca6.js"></script>
<script src="/k8s-notes/runtime~main.a4215b58.js"></script>
<script src="/k8s-notes/main.3878add6.js"></script>
<script src="/k8s-notes/1.d74cfc91.js"></script>
<script src="/k8s-notes/25.575fc837.js"></script>
<script src="/k8s-notes/935f2afb.93050429.js"></script>
<script src="/k8s-notes/24.e6edf205.js"></script>
<script src="/k8s-notes/13e78a50.8a02b856.js"></script>
</body>
</html>